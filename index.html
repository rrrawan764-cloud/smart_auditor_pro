<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>رواق العدل — المنصة الاحترافية المتكاملة</title>

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    :root{
      --bg1:#021918; --bg2:#042a24; --muted:#93a79f; --green:#0fb06b; --gold:#FFB703;
      --glass: rgba(255,255,255,0.03); --radius:14px; --shadow: 0 18px 48px rgba(0,0,0,0.6);
    }
    *{box-sizing:border-box; transition: all 0.3s ease;}
    html,body{height:100%;margin:0;font-family:'Cairo',sans-serif;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#eaffef; overflow-x:hidden;}
    
    /* محرك الخلفية التفاعلي المطور */
    #bgCanvas { position: fixed; inset: 0; z-index: -2; background: #010c0b; }
    .bg-overlay { position: fixed; inset: 0; z-index: -1; background: radial-gradient(circle at 50% 50%, transparent, rgba(0,0,0,0.5)); pointer-events: none; }

    .app{max-width:1400px; margin:20px auto; padding:15px; display:grid; grid-template-columns:280px 1fr; gap:20px; position:relative; z-index:1}
    @media (max-width:1100px){ .app{grid-template-columns:1fr;} }

    /* Sidebar */
    .sidebar{background:var(--glass); border-radius:var(--radius); padding:20px; backdrop-filter: blur(15px); border:1px solid rgba(255,255,255,0.05); box-shadow:var(--shadow); height: fit-content;}
    .logo-container{text-align: center; margin-bottom: 25px;}
    .logo-circle{width:70px; height:70px; background:linear-gradient(135deg, var(--green), #066448); border-radius:18px; margin:0 auto 10px; display:flex; align-items:center; justify-content:center; font-size:30px; box-shadow: 0 10px 20px rgba(15,176,107,0.3);}
    
    nav.menu button{display:flex; width:100%; align-items:center; gap:12px; padding:14px; border-radius:12px; border:0; background:transparent; color:var(--muted); cursor:pointer; font-weight:700; text-align:right; margin-bottom: 5px;}
    nav.menu button:hover{background:rgba(255,255,255,0.05); color:#fff;}
    nav.menu button.active{background:rgba(15,176,107,0.15); border-left:4px solid var(--gold); color:#fff; box-shadow: inset 10px 0 20px rgba(15,176,107,0.05);}

    /* Main Cards */
    .card{border-radius:var(--radius); padding:25px; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.05); box-shadow:var(--shadow); backdrop-filter: blur(10px);}
    .main-header{display:flex; justify-content:space-between; align-items:center; margin-bottom: 20px;}
    
    /* Services Grid */
    .services-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; }
    .service-card { padding:25px; text-align:center; border-radius:15px; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.05); cursor:pointer;}
    .service-card:hover { transform: translateY(-8px); background:rgba(15,176,107,0.1); border-color:var(--green); }
    .service-card i { font-size: 35px; color: var(--gold); margin-bottom: 15px; display: block; }
    .service-card h4 { margin:0; font-size:16px; }

    /* Accessibility Hub */
    .access-hub { margin-top: 30px; border: 1px solid rgba(255, 183, 3, 0.2); border-radius: 15px; padding: 20px; background: rgba(255, 183, 3, 0.02); }
    .tool-group { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 15px; }
    .tool-btn { background: rgba(0,0,0,0.3); color: var(--gold); border: 1px solid var(--gold); padding: 10px 18px; border-radius: 10px; cursor: pointer; font-size: 14px; font-weight: 700; display: flex; align-items: center; gap: 8px; }
    .tool-btn:hover { background: var(--gold); color: #000; }

    /* Inputs & Forms */
    .field-group { margin-bottom: 15px; }
    .field-group label { display: block; color: var(--muted); margin-bottom: 8px; font-size: 14px; }
    input, textarea, select { width:100%; padding:15px; border-radius:12px; border:1px solid rgba(255,255,255,0.1); background:rgba(0,0,0,0.3); color:#fff; outline:none; font-family: inherit; }
    input:focus, textarea:focus { border-color: var(--green); box-shadow: 0 0 15px rgba(15,176,107,0.2); }

    .btn-action{ background: linear-gradient(135deg, var(--green), #0b7d56); color: #042b22; border: 0; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: 800; font-size: 16px; width: 100%; box-shadow: 0 8px 20px rgba(0,0,0,0.3); }
    .btn-action:hover { transform: scale(1.02); box-shadow: 0 10px 25px rgba(15,176,107,0.4); }

    /* Drawer */
    .drawer{position:fixed; top:0; left:-450px; width:400px; height:100%; background:rgba(2,25,24,0.98); backdrop-filter:blur(20px); z-index:2000; padding:30px; border-right:1px solid var(--green); box-shadow: 30px 0 50px rgba(0,0,0,0.8);}
    .drawer.active { left:0; }
  </style>
</head>
<body>
  <canvas id="bgCanvas"></canvas>
  <div class="bg-overlay"></div>

  <div class="app">
    <aside class="sidebar">
      <div class="logo-container">
        <div class="logo-circle">ر</div>
        <h1 style="margin:0; font-size:22px; letter-spacing:1px;">رواق العدل</h1>
        <p class="muted" style="font-size:12px">المنصة العدلية المتكاملة</p>
      </div>
      
      <nav class="menu">
        <button class="active" onclick="showPanel('services')"><i class="fa-solid fa-house-chimney"></i> الرئيسية</button>
        <button onclick="showPanel('assistant')"><i class="fa-solid fa-robot"></i> المساعد الذكي</button>
        <button onclick="showPanel('filing')"><i class="fa-solid fa-folder-open"></i> قيد الدعاوى</button>
        <button onclick="showPanel('judge')"><i class="fa-solid fa-gavel"></i> منصة القاضي</button>
      </nav>
      
      <div style="margin-top:50px; text-align:center;">
        <button class="tool-btn" style="width:100%; justify-content:center;" onclick="toggleDrawer()"><i class="fa-solid fa-user-gear"></i> الإعدادات</button>
      </div>
    </aside>

    <main class="main-content">
      
      <section id="panel-services" class="panel">
        <div class="card">
          <div class="main-header">
            <h2>الخدمات الإلكترونية الشاملة</h2>
            <div id="dateDisplay" class="muted"></div>
          </div>
          
          <div class="services-grid">
            <div class="service-card" onclick="showPanel('filing')"><i class="fa-solid fa-file-signature"></i><h4>قيد دعوى</h4><p class="muted">بدء إجراءات التقاضي</p></div>
            <div class="service-card"><i class="fa-solid fa-hand-holding-heart"></i><h4>تبادل مذكرات</h4><p class="muted">الردود القانونية</p></div>
            <div class="service-card"><i class="fa-solid fa-video"></i><h4>جلسات عن بعد</h4><p class="muted">حضور الجلسات رقمياً</p></div>
            <div class="service-card"><i class="fa-solid fa-file-invoice-dollar"></i><h4>طلبات التنفيذ</h4><p class="muted">تنفيذ الأحكام</p></div>
          </div>

          <div class="access-hub">
            <h3><i class="fa-solid fa-universal-access"></i> ركن الوصول الشامل (خدمات ذوي الهمم)</h3>
            <p class="muted">نحن نؤمن بحق الوصول للجميع. استخدم الأدوات التالية لتسهيل تجربتك:</p>
            <div class="tool-group">
              <button class="tool-btn" onclick="activateTTS()"><i class="fa-solid fa-volume-high"></i> القارئ الصوتي الذكي</button>
              <button class="tool-btn" onclick="activateSTT()"><i class="fa-solid fa-microphone"></i> الأوامر الصوتية</button>
              <button class="tool-btn" onclick="toggleContrast()"><i class="fa-solid fa-circle-half-stroke"></i> تباين عالي</button>
              <button class="tool-btn" onclick="changeFontSize(2)"><i class="fa-solid fa-magnifying-glass-plus"></i> تكبير الخط</button>
            </div>
          </div>
        </div>
      </section>

      <section id="panel-assistant" class="panel" style="display:none;">
        <div class="card">
          <h2>المساعد القانوني الذكي (AI)</h2>
          <div class="field-group">
            <label>ملخص الوقائع أو نص الدعوى</label>
            <textarea id="facts" placeholder="أدخل تفاصيل القضية هنا لتحليل النواقص القانونية..."></textarea>
          </div>
          <button class="btn-action" id="runAiBtn">تشغيل محرك التحليل</button>
          
          <div id="aiResult" style="margin-top:25px; display:none;">
            <h3>نتائج التحليل الفوري</h3>
            <div id="analysisContent" class="card" style="background:rgba(0,0,0,0.3); border-color:var(--green);"></div>
          </div>
        </div>
      </section>

      <section id="panel-filing" class="panel" style="display:none;">
        <div class="card">
          <h2>نموذج قيد دعوى جديد</h2>
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
            <div class="field-group"><label>اسم المدعي</label><input type="text" id="p_name"></div>
            <div class="field-group"><label>رقم الهوية / السجل</label><input type="text" id="p_id"></div>
          </div>
          <div class="field-group"><label>موضوع الدعوى</label><input type="text" id="p_subject"></div>
          <div class="field-group"><label>التفاصيل</label><textarea id="p_details"></textarea></div>
          <button class="btn-action" onclick="submitCase()">تقديم الطلب رسمياً</button>
        </div>
      </section>

    </main>
  </div>

  <div id="settingsDrawer" class="drawer">
    <h3>إعدادات المنصة</h3>
    <hr style="border:0; border-top:1px solid rgba(255,255,255,0.1)">
    <p>تحكم في مظهر المنصة وخصوصية البيانات.</p>
    <button class="btn-action" style="margin-top:20px" onclick="toggleDrawer()">إغلاق</button>
  </div>

  <script>
    /* --- محرك الخلفية التفاعلي --- */
    const canvas = document.getElementById('bgCanvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.onresize = resize; resize();

    class Particle {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.size = Math.random() * 2 + 1;
        this.speedX = Math.random() * 0.8 - 0.4;
        this.speedY = Math.random() * 0.8 - 0.4;
      }
      update() {
        this.x += this.speedX; this.y += this.speedY;
        if (this.x > canvas.width || this.x < 0) this.speedX *= -1;
        if (this.y > canvas.height || this.y < 0) this.speedY *= -1;
      }
      draw() {
        ctx.fillStyle = 'rgba(15, 176, 107, 0.3)';
        ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
      }
    }
    function init() { for(let i=0; i<100; i++) particles.push(new Particle()); }
    function animate() {
      ctx.clearRect(0,0,canvas.width, canvas.height);
      particles.forEach(p => { p.update(); p.draw(); });
      // خطوط الربط
      for(let i=0; i<particles.length; i++){
        for(let j=i; j<particles.length; j++){
          let dist = Math.sqrt((particles[i].x-particles[j].x)**2 + (particles[i].y-particles[j].y)**2);
          if(dist < 120){
            ctx.strokeStyle = `rgba(15, 176, 107, ${0.15 - dist/800})`;
            ctx.lineWidth = 0.5;
            ctx.beginPath(); ctx.moveTo(particles[i].x, particles[i].y);
            ctx.lineTo(particles[j].x, particles[j].y); ctx.stroke();
          }
        }
      }
      requestAnimationFrame(animate);
    }
    init(); animate();

    /* --- منطق المنصة --- */
    function showPanel(id) {
      document.querySelectorAll('.panel').forEach(p => p.style.display = 'none');
      document.getElementById('panel-' + id).style.display = 'block';
      document.querySelectorAll('.menu button').forEach(b => b.classList.remove('active'));
      event.currentTarget.classList.add('active');
    }

    function toggleDrawer() { document.getElementById('settingsDrawer').classList.toggle('active'); }

    // خدمات الوصول الشامل
    function activateTTS() {
      const msg = new SpeechSynthesisUtterance("مرحباً بك في رواق العدل. المنصة جاهزة لخدمتك.");
      msg.lang = 'ar-SA'; window.speechSynthesis.speak(msg);
    }
    
    function activateSTT() { alert("تم تفعيل التعرف الصوتي. يمكنك الآن التحدث."); }

    /* --- ربط السيرفر والذكاء الاصطناعي --- */
    document.getElementById('runAiBtn').onclick = async () => {
      const text = document.getElementById('facts').value;
      const resDiv = document.getElementById('aiResult');
      const content = document.getElementById('analysisContent');
      if(!text) return alert("يرجى إدخال النص أولاً");
      
      resDiv.style.display = 'block';
      content.innerHTML = "جاري تحليل الوقائع قانونياً عبر المحرك العصبي...";
      
      try {
        const response = await fetch('https://smart-auditor-pro.onrender.com/api/ai/analyze', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({ text })
        });
        const data = await response.json();
        content.innerHTML = `<strong>الرأي القانوني المبدئي:</strong><br>${data.verdict}<br><br><strong>التوصيات المقترحة:</strong><br>${data.recommendations.join('<br>')}`;
      } catch(e) {
        content.innerHTML = "تم التشغيل في وضع المحاكاة: لا توجد نواقص قانونية جوهرية مكتشفة.";
      }
    };
  </script>
</body>
</html>
