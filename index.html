<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>رواق العدل — منصة متكاملة</title>

  <!-- خطوط -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    :root{
      --bg-1: #f3f6f4;
      --bg-2: #eaf0ea;
      --glass: rgba(255,255,255,0.65);
      --glass-strong: rgba(255,255,255,0.85);
      --muted: #51605a;
      --green: #116938;
      --gold: #FFB703;
      --accent: rgba(17,105,56,0.08);
      --radius: 14px;
      --card-shadow: 0 16px 40px rgba(9,20,14,0.06);
    }

    /* Page base */
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Cairo',sans-serif;background:linear-gradient(180deg,var(--bg-1),var(--bg-2));color:#0b2a1a; -webkit-font-smoothing:antialiased}
    a{color:var(--green)}

    /* App layout */
    .app{display:flex; gap:20px; padding:20px; min-height:100vh; align-items:flex-start}
    aside.sidebar{
      width:320px; border-radius:16px; padding:18px; background: linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.80));
      border: 1px solid rgba(0,0,0,0.04); box-shadow: var(--card-shadow);
      backdrop-filter: blur(6px);
      display:flex; flex-direction:column; gap:12px;
    }
    main{flex:1; display:flex; flex-direction:column; gap:16px}

    /* Header / Brand */
    .brand{display:flex;gap:12px; align-items:center}
    .logo{
      width:84px; height:84px; border-radius:14px; display:flex; align-items:center; justify-content:center;
      background: linear-gradient(180deg,var(--green), #0f5a31);
      box-shadow: 0 12px 36px rgba(17,105,56,0.12);
      cursor:pointer; transition: transform .18s;
    }
    .logo:focus, .logo:hover{ transform: translateY(-4px); }
    .brand h1{margin:0; font-size:18px; color:#071018; font-weight:800}
    .brand p{margin:0; font-size:13px; color:var(--muted)}

    /* Sidebar menu */
    nav.menu{display:flex; flex-direction:column; gap:8px; margin-top:6px}
    .menu button{
      display:flex; align-items:center; gap:10px; padding:12px; border-radius:10px; border:none;
      background:transparent; text-align:right; color:var(--muted); cursor:pointer; font-weight:600;
    }
    .menu button.active{ background: linear-gradient(90deg,var(--accent), rgba(255,255,255,0.6)); border-left:4px solid var(--gold); color:#071018 }
    .menu .ico{width:36px; height:36px; display:flex; align-items:center; justify-content:center; border-radius:8px; background:rgba(255,255,255,0.6) }

    footer.sidebar-foot{ margin-top:auto; font-size:12px; color:var(--muted); text-align:center }

    /* Topbar */
    .topbar{display:flex; gap:12px; align-items:center; justify-content:space-between}
    .search{
      flex:1; max-width:820px; display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.82));
      border:1px solid rgba(0,0,0,0.04);
      box-shadow: 0 8px 30px rgba(0,0,0,0.03);
    }
    .search input{border:0; background:transparent; outline:none; padding:6px 8px; font-size:14px; color:#0b2a1a}
    .controls{display:flex; gap:8px; align-items:center}

    /* Grid */
    .content-grid{display:grid; grid-template-columns: 1fr 380px; gap:16px}
    .card{
      border-radius:14px; padding:16px; background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.86));
      border: 1px solid rgba(0,0,0,0.04); box-shadow: var(--card-shadow); backdrop-filter: blur(6px);
    }

    /* Titles */
    h2{margin:0 0 8px 0; color:var(--green)}
    h3{margin:0 0 8px 0; color:var(--gold)}
    .muted{color:var(--muted); font-size:13px}

    /* Transparent / glass inputs */
    .input, textarea, select {
      width:100%; padding:10px; border-radius:10px; border:1px solid rgba(10,20,10,0.04);
      background: rgba(255,255,255,0.7); color:#0b2a1a; outline:none; transition:box-shadow .12s, transform .12s;
      backdrop-filter: blur(4px);
    }
    .input:focus, textarea:focus, select:focus { box-shadow: 0 8px 18px rgba(17,105,56,0.06); transform: translateY(-2px); border-color: rgba(17,105,56,0.18); }

    textarea { min-height:140px; resize:vertical }

    /* Buttons */
    .btn {
      background: linear-gradient(180deg,var(--green), #0d5b33); color:#fff; border:0; padding:10px 14px; border-radius:10px;
      cursor:pointer; font-weight:800; box-shadow: 0 10px 26px rgba(17,105,56,0.10);
    }
    .btn.secondary { background: transparent; color:var(--green); border:1px solid rgba(17,105,56,0.10); box-shadow:none; font-weight:700 }

    /* Uploader */
    .uploader {
      border:2px dashed rgba(0,0,0,0.06); padding:14px; border-radius:10px; text-align:center;
      color:var(--muted); background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.68));
    }
    .progress{height:8px; background:#eef6ee; border-radius:8px; overflow:hidden; margin-top:8px}
    .progress>i{display:block;height:100%; background: linear-gradient(90deg,var(--green),var(--gold)); width:0%}

    /* Services grid */
    .services-grid{display:grid; grid-template-columns: repeat(auto-fit,minmax(180px,1fr)); gap:12px}
    .service{padding:14px; border-radius:12px; cursor:pointer; background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.68)); border:1px solid rgba(0,0,0,0.04); transition:transform .14s, box-shadow .14s}
    .service:hover{ transform: translateY(-6px); box-shadow: 0 14px 40px rgba(10,20,14,0.06) }

    /* Right column */
    aside.right-col{display:flex; flex-direction:column; gap:12px}

    /* Responsive */
    @media (max-width:980px){
      .content-grid{grid-template-columns:1fr}
      aside.sidebar{width:100%}
      .app{flex-direction:column; padding:12px}
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="رواق العدل — المنصة المتكاملة">
    <!-- SIDEBAR -->
    <aside class="sidebar" aria-label="الشريط الجانبي">
      <div class="brand" role="img" aria-label="شعار رواق العدل">
        <!-- Refined official logo SVG: swords + palm + scale -->
        <div class="logo" id="brandLogo" tabindex="0" aria-hidden="false" title="رواق العدل — الشعار الرسمي">
          <svg viewBox="0 0 120 120" width="72" height="72" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="شعار رواق العدل">
            <defs>
              <linearGradient id="g-green" x1="0" x2="0" y1="0" y2="1">
                <stop offset="0" stop-color="#2aa05a"/>
                <stop offset="1" stop-color="#116938"/>
              </linearGradient>
              <linearGradient id="g-gold" x1="0" x2="1">
                <stop offset="0" stop-color="#fff0b8"/>
                <stop offset="1" stop-color="#FFB703"/>
              </linearGradient>
              <filter id="ds" x="-50%" y="-50%" width="200%" height="200%">
                <feDropShadow dx="0" dy="3" stdDeviation="5" flood-color="#000" flood-opacity="0.18"/>
              </filter>
            </defs>

            <!-- Crossed swords (back) -->
            <g transform="translate(60,62)" opacity="0.96">
              <g transform="rotate(-28)">
                <rect x="-1.6" y="-48" width="3.2" height="92" rx="0.9" fill="#dcdcdc"/>
                <polygon points="-7,-48 7,-48 0,-56" fill="#dcdcdc"/>
                <rect x="-7" y="36" width="14" height="4.4" rx="1.1" fill="#b28627"/>
              </g>
              <g transform="rotate(28)">
                <rect x="-1.6" y="-48" width="3.2" height="92" rx="0.9" fill="#dcdcdc"/>
                <polygon points="-7,-48 7,-48 0,-56" fill="#dcdcdc"/>
                <rect x="-7" y="36" width="14" height="4.4" rx="1.1" fill="#b28627"/>
              </g>
            </g>

            <!-- Palm silhouette (middle) -->
            <g transform="translate(60,36)" opacity="0.98">
              <rect x="-3.2" y="8" width="6.4" height="30" rx="1.2" fill="url(#g-green)" />
              <path d="M0,6 C8,0 20,-6 36,-4" fill="none" stroke="#1f8a4c" stroke-width="2.6" stroke-linecap="round" transform="translate(-18,-6) rotate(-18)"/>
              <path d="M0,6 C8,0 20,-6 36,-4" fill="none" stroke="#1f8a4c" stroke-width="2.6" stroke-linecap="round" transform="translate(-18,-6) rotate(18)"/>
              <path d="M0,6 C6,1 16,-3 28,-2" fill="none" stroke="#1f8a4c" stroke-width="2.2" stroke-linecap="round" transform="translate(-12,-10) rotate(-36)"/>
              <path d="M0,6 C6,1 16,-3 28,-2" fill="none" stroke="#1f8a4c" stroke-width="2.2" stroke-linecap="round" transform="translate(8,-10) rotate(36)"/>
            </g>

            <!-- Scale (foreground gold) -->
            <g transform="translate(60,48)" filter="url(#ds)">
              <rect x="-2.8" y="2" width="5.6" height="36" rx="1.4" fill="#cfcfcf"/>
              <g transform="translate(0,10)">
                <rect x="-30" y="-3.6" width="60" height="7.2" rx="3.6" fill="url(#g-gold)"/>
                <circle cx="0" cy="-14" r="4" fill="#cfcfcf"/>
                <line x1="-20" y1="-1" x2="-20" y2="14" stroke="#cfcfcf" stroke-width="1.1" stroke-linecap="round"/>
                <line x1="20" y1="-1" x2="20" y2="14" stroke="#cfcfcf" stroke-width="1.1" stroke-linecap="round"/>
                <g transform="translate(-20,26)">
                  <ellipse rx="12.5" ry="4.8" fill="#fff3d6" stroke="#d1a94e" stroke-width="0.9"/>
                </g>
                <g transform="translate(20,26)">
                  <ellipse rx="12.5" ry="4.8" fill="#fff3d6" stroke="#d1a94e" stroke-width="0.9"/>
                </g>
              </g>
              <rect x="-16" y="44" width="32" height="6" rx="2" fill="#2b2b2b" opacity="0.7"/>
            </g>
          </svg>
        </div>

        <div>
          <h1>رواق العدل</h1>
          <p class="muted">منصة قضائية متكاملة — أمان، وصول، وكفاءة</p>
        </div>
      </div>

      <nav class="menu" role="navigation" aria-label="قائمة الخدمات">
        <button class="active" data-panel="assistant"><span class="ico"><i class="fa-solid fa-brain"></i></span>المساعد الذكي</button>
        <button data-panel="services"><span class="ico"><i class="fa-solid fa-layer-group"></i></span>الخدمات الشاملة</button>
        <button data-panel="casefile"><span class="ico"><i class="fa-solid fa-file-circle-plus"></i></span>قيد دعوى</button>
        <button data-panel="memo"><span class="ico"><i class="fa-solid fa-file-lines"></i></span>تبادل مذكرات</button>
        <button data-panel="sessions"><span class="ico"><i class="fa-solid fa-video"></i></span>جلسات رقمية</button>
        <button data-panel="judgeboard"><span class="ico"><i class="fa-solid fa-balance-scale"></i></span>منصة القاضي</button>
        <button data-panel="accessibility"><span class="ico"><i class="fa-solid fa-universal-access"></i></span>الوصول</button>
        <button data-panel="security"><span class="ico"><i class="fa-solid fa-shield"></i></span>الأمن</button>
      </nav>

      <footer class="sidebar-foot">
        روان الصبحي — © 2026<br><a href="./LICENSE">شروط الترخيص</a>
      </footer>
    </aside>

    <!-- MAIN -->
    <main>
      <!-- topbar -->
      <div class="topbar">
        <div class="search" role="search" aria-label="بحث موحد">
          <i class="fa-solid fa-magnifying-glass" style="color:var(--muted)"></i>
          <input id="unifiedSearch" placeholder="استعلام موحّد: رقم قضية، اسم، قرار..." aria-label="استعلام موحّد">
        </div>

        <div class="controls">
          <button id="themeToggle" class="btn secondary" title="تبديل السمة">سمة</button>
          <button id="userBtn" class="btn secondary">المحكمة الإلكترونية</button>
        </div>
      </div>

      <div class="content-grid" role="main">
        <!-- LEFT: panels -->
        <section id="panels" style="min-height:560px">
          <!-- Assistant panel -->
          <article id="panel-assistant" class="card panel" role="region" aria-labelledby="assistantTitle">
            <h2 id="assistantTitle">المساعد الذكي — تدقيق وتحليل</h2>
            <p class="muted">أدخل ملخص الوقائع أو ارفع المستندات. المساعد يقترح نواقص، نقاط قانونية ومسودات جاهزة.</p>

            <div style="margin-top:12px" class="form-row">
              <label for="facts">ملخص الوقائع</label>
              <textarea id="facts" placeholder="اكتب ملخص الدعوى أو الصق نصاً..."></textarea>
            </div>

            <div class="form-row" style="margin-top:10px; align-items:flex-start">
              <div style="flex:1">
                <div class="uploader" id="uploader" tabindex="0" aria-label="اسحب الملفات أو اضغط للاختيار">اسحب الملفات هنا أو اضغط للاختيار (PDF، صور)</div>
                <div class="progress" id="uploadProgress" hidden><i></i></div>
              </div>

              <div style="width:220px; display:flex; flex-direction:column; gap:10px">
                <button class="btn" id="runAi">تشغيل التدقيق الذكي</button>
                <button class="btn secondary" id="saveDraft">حفظ مسودة</button>
              </div>
            </div>

            <div id="aiResult" style="margin-top:14px" hidden>
              <div class="card">
                <h3>نتيجة التحليل</h3>
                <div id="analysisContent" class="muted">لا توجد نتيجة بعد.</div>
                <div style="margin-top:10px; display:flex; gap:8px">
                  <button class="btn" id="exportDoc">توليد مستند</button>
                  <button class="btn secondary" id="sendToJudge">إحالة إلى القاضي</button>
                </div>
              </div>
            </div>
          </article>

          <!-- Services -->
          <article id="panel-services" class="card panel" role="region" aria-labelledby="servicesTitle" hidden>
            <h2 id="servicesTitle">الخدمات الشاملة</h2>
            <p class="muted">بوابة موحدة للخدمات المؤسسية المدمجة مع المساعد الذكي وأنظمة الأرشفة والتوقيع.</p>

            <div style="margin-top:12px" class="services-grid">
              <div class="service" data-service="casefile"><h4>قيد دعوى إلكتروني</h4><p class="muted">نموذج ذكي، مرفقات، وتحقق آلي من النواقص.</p></div>
              <div class="service" data-service="memo"><h4>تبادل مذكرات</h4><p class="muted">بيئة مؤمنة مع PKI وتتبّع نسخ.</p></div>
              <div class="service" data-service="sessions"><h4>جلسات رقمية</h4><p class="muted">روابط مؤمنة، تفريغ صوتي، وبصمة زمنية.</p></div>
              <div class="service" data-service="inquiry"><h4>استعلام موحّد</h4><p class="muted">بحث عن قضايا، أحكام، وأطراف.</p></div>
              <div class="service" data-service="archiving"><h4>أرشفة موثقة</h4><p class="muted">حفظ آمن مع تدقيق سلامة المحتوى.</p></div>
              <div class="service" data-service="analytics"><h4>تقارير وتحليلات</h4><p class="muted">لوحات أداء ومؤشرات زمنية.</p></div>
            </div>
          </article>

          <!-- Case filing -->
          <article id="panel-casefile" class="card panel" role="region" aria-labelledby="casefileTitle" hidden>
            <h2 id="casefileTitle">قيد دعوى جديد</h2>
            <p class="muted">املأ الحقول وأرفق المستندات — المساعد سيتحقق آليا قبل القيد.</p>

            <form id="caseForm" onsubmit="return false" style="margin-top:12px">
              <div class="form-row" style="gap:12px">
                <div style="flex:1">
                  <label>اسم المدعي</label>
                  <input id="plaintiff" class="input" required />
                </div>
                <div style="width:200px">
                  <label>رقم القضية (اختياري)</label>
                  <input id="caseNumber" class="input" />
                </div>
              </div>

              <div style="margin-top:10px">
                <label>موضوع الدعوى</label>
                <input id="subject" class="input" required />
              </div>

              <div style="margin-top:10px">
                <label>تفاصيل</label>
                <textarea id="details" class="input" required></textarea>
              </div>

              <div style="display:flex; gap:8px; align-items:center; margin-top:10px">
                <div style="flex:1"><div class="uploader" id="caseUploader">اسحب مستندات الدعوى أو اضغط للاختيار</div></div>
                <div style="width:160px"><button class="btn" id="submitCase">قيد الدعوى</button></div>
              </div>

              <div id="caseFeedback" class="muted" style="margin-top:8px" hidden></div>
            </form>
          </article>

          <!-- Memo -->
          <article id="panel-memo" class="card panel" role="region" aria-labelledby="memoTitle" hidden>
            <h2 id="memoTitle">تبادل مذكرات</h2>
            <p class="muted">أرسل مذكرات واحفظ سجل التراسل مع تواريخ وتوقيع رقمي عند الحاجة.</p>

            <div style="display:flex; gap:10px; margin-top:10px">
              <div style="flex:1">
                <ul id="memoList" style="list-style:none; padding:0; margin:0"></ul>
              </div>
              <div style="width:300px">
                <label>مذكرة جديدة</label>
                <textarea id="memoText" class="input"></textarea>
                <button class="btn" id="sendMemo" style="margin-top:8px">إرسال</button>
              </div>
            </div>
          </article>

          <!-- Sessions -->
          <article id="panel-sessions" class="card panel" role="region" aria-labelledby="sessionsTitle" hidden>
            <h2 id="sessionsTitle">جلسات رقمية</h2>
            <p class="muted">حجز، ربط مع التقويم، وإنشاء روابط مؤمنة للجلسات.</p>

            <div style="margin-top:10px">
              <label>موضوع الجلسة</label>
              <input id="sessionSubj" class="input" />
              <div style="display:flex; gap:8px; margin-top:8px">
                <div style="flex:1">
                  <label>التاريخ والوقت</label>
                  <input id="sessionDate" type="datetime-local" class="input" />
                </div>
                <div style="width:150px; display:flex; align-items:end">
                  <button class="btn" id="createSession">إنشاء جلسة</button>
                </div>
              </div>
              <div id="sessionList" style="margin-top:12px"></div>
            </div>
          </article>

          <!-- Judge board -->
          <article id="panel-judgeboard" class="card panel" role="region" aria-labelledby="judgeTitle" hidden>
            <h2 id="judgeTitle">منصة القاضي</h2>
            <p class="muted">لوحة قرار تعرض أولويات، تنبيهات الذكاء الاصطناعي ومقترحات الأوامر.</p>

            <div style="display:flex; gap:12px; margin-top:12px">
              <div style="flex:1" class="card">
                <h3>قضايا اليوم</h3>
                <div id="todayCases" class="muted">تحميل...</div>
              </div>
              <div style="width:320px" class="card">
                <h3>مخطط الحالة</h3>
                <canvas id="judgeChart" style="max-height:160px"></canvas>
              </div>
            </div>
          </article>

          <!-- Accessibility -->
          <article id="panel-accessibility" class="card panel" role="region" aria-labelledby="accessTitle" hidden>
            <h2 id="accessTitle">الوصول</h2>
            <p class="muted">TTS، STT، والترجمات الحينية (EN ↔ AR) — واجهات سهلة الوصول.</p>

            <div style="display:flex; gap:8px; margin-top:10px">
              <button class="btn" id="enableTTS">تشغيل القراءة</button>
              <button class="btn secondary" id="enableCaptions">تفعيل الترجمة الحينية</button>
              <button class="btn secondary" id="startSTT">بدء أوامر صوتية</button>
            </div>
          </article>

          <!-- Security -->
          <article id="panel-security" class="card panel" role="region" aria-labelledby="securityTitle" hidden>
            <h2 id="securityTitle">الأمن والامتثال</h2>
            <p class="muted">PKI، توقيع رقمي، SSO، تشفير، وسجلات تدقيق قابلة للتصدير.</p>
            <ul class="muted" style="margin-top:8px">
              <li>حماية مفاتيح API في الخادم وتخزين آمن</li>
              <li>مصادقة متعددة العوامل (MFA) وRBAC</li>
              <li>تقارير امتثال قابلة للتصدير</li>
            </ul>
          </article>
        </section>

        <!-- RIGHT column -->
        <aside class="right-col">
          <div class="card">
            <h3>إجراءات سريعة</h3>
            <div style="display:flex; flex-direction:column; gap:8px; margin-top:10px">
              <button class="btn" onclick="openPanel('casefile')">قيد دعوى</button>
              <button class="btn secondary" onclick="openPanel('memo')">مذكرة</button>
              <button class="btn secondary" onclick="openPanel('sessions')">جلسة</button>
            </div>
          </div>

          <div class="card">
            <h3>التكاملات</h3>
            <p class="muted" style="margin-top:8px">OpenAI · Azure Speech · Google OCR · PKI/HSM · S3 · SSO</p>
            <button class="btn secondary" onclick="showIntegration()">تفاصيل الربط</button>
          </div>

          <div class="card">
            <h3>التواصل</h3>
            <p class="muted" style="margin-top:8px">licensing@rawan.dev</p>
            <button class="btn" onclick="contactLicensing()">اتصل</button>
          </div>
        </aside>
      </div>
    </main>
  </div>

  <script>
    /* ========== UI behavior (demo) ========== */

    // Panel navigation
    document.querySelectorAll('.menu button').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.menu button').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        openPanel(btn.dataset.panel);
      });
    });

    function openPanel(name){
      const mapping = {
        assistant: 'panel-assistant',
        services: 'panel-services',
        casefile: 'panel-casefile',
        memo: 'panel-memo',
        sessions: 'panel-sessions',
        judgeboard: 'panel-judgeboard',
        accessibility: 'panel-accessibility',
        security: 'panel-security'
      };
      document.querySelectorAll('#panels > article, #panels > section').forEach(el => el.hidden = true);
      const id = mapping[name] || ('panel-' + name);
      const el = document.getElementById(id);
      if(el) el.hidden = false;
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // Setup uploader (drag & drop simulation)
    function setupUploader(el, progressId){
      el.addEventListener('click', ()=> {
        const inp = document.createElement('input');
        inp.type = 'file'; inp.multiple = true;
        inp.onchange = ()=> simulateUpload(inp.files, progressId);
        inp.click();
      });
      ['dragenter','dragover'].forEach(e => el.addEventListener(e, ev => { ev.preventDefault(); el.style.borderColor = 'var(--green)'; }));
      ['dragleave','drop'].forEach(e => el.addEventListener(e, ev => { ev.preventDefault(); el.style.borderColor = ''; if(e === 'drop') simulateUpload(ev.dataTransfer.files, progressId); }));
    }
    function simulateUpload(files, progressId){
      if(!files || files.length === 0) return;
      const progress = document.getElementById('uploadProgress');
      progress.hidden = false;
      const bar = progress.querySelector('i');
      let pct = 0;
      const step = 100 / (files.length * 10);
      const interval = setInterval(()=> {
        pct = Math.min(100, pct + step);
        bar.style.width = pct + '%';
        if(pct >= 100) {
          clearInterval(interval);
          setTimeout(()=>{ progress.hidden = true; bar.style.width='0%'; alert(files.length + ' ملف(ملفات) جاهز (محاكاة)'); }, 350);
        }
      }, 120);
    }
    setupUploader(document.getElementById('uploader'));
    setupUploader(document.getElementById('caseUploader'));

    // Run AI (demo)
    document.getElementById('runAi').addEventListener('click', ()=>{
      const facts = document.getElementById('facts').value.trim();
      const resBlock = document.getElementById('aiResult');
      const content = document.getElementById('analysisContent');
      resBlock.hidden = false;
      content.textContent = 'جارٍ تحليل الوثائق والسياق — الرجاء الانتظار...';
      // Example: POST /api/ai/analyze { text, files } -> backend calls OpenAI/Azure and returns analysis
      setTimeout(()=> {
        const result = {
          verdict: 'تظلم إداري — احتمالية قبول مبدئية: 75%',
          issues: ['غياب إثبات التبليغ', 'نقص التفويض'],
          recommendations: ['إرفاق إيصال التبليغ', 'رفع تفويض موقّع', 'طلب مهلة مؤقتة إن لزم']
        };
        content.innerHTML = `<strong>${result.verdict}</strong>
          <ul style="margin:8px 0 0 0; padding-inline-start:18px">${result.issues.map(i=>`<li>${i}</li>`).join('')}</ul>
          <div style="margin-top:8px"><strong>توصيات:</strong>
            <ol style="margin:6px 0 0 0; padding-inline-start:18px">${result.recommendations.map(r=>`<li>${r}</li>`).join('')}</ol>
          </div>`;
      }, 900);
    });

    // Case submission (demo)
    document.getElementById('submitCase').addEventListener('click', ()=>{
      const plaintiff = document.getElementById('plaintiff').value.trim();
      const subject = document.getElementById('subject').value.trim();
      const details = document.getElementById('details').value.trim();
      const feedback = document.getElementById('caseFeedback');
      if(!plaintiff || !subject || !details){ feedback.hidden = false; feedback.textContent = 'يرجى ملء الحقول المطلوبة.'; return; }
      feedback.hidden = false; feedback.textContent = 'جاري إرسال طلب القيد...';
      setTimeout(()=> feedback.textContent = 'تم قيد الدعوى بنجاح — مرجع: 2026-00123 (محاكاة)', 900);
    });

    // Memos
    const memoList = document.getElementById('memoList');
    const memos = [
      {id:1, from:'المحكمة', subject:'طلب وثائق', time:'2026-01-10', text:'يرجى إرفاق إثبات التبليغ.'},
      {id:2, from:'المدعى', subject:'رد', time:'2026-01-11', text:'تم إرفاق المستندات المطلوبة.'}
    ];
    function renderMemos(){ memoList.innerHTML = memos.map(m=>`<li style="padding:8px;border-bottom:1px dashed #eef">${m.time} — <strong>${m.from}</strong>: ${m.subject}<div class="muted" style="font-size:13px;margin-top:6px">${m.text}</div></li>`).join(''); }
    renderMemos();
    document.getElementById('sendMemo').addEventListener('click', ()=>{
      const text = document.getElementById('memoText').value.trim();
      if(!text) return alert('اكتب نص المذكرة');
      memos.unshift({id:Date.now(), from:'أنت', subject:'مذكرة', time:new Date().toLocaleString(), text});
      document.getElementById('memoText').value='';
      renderMemos();
    });

    // Sessions (demo)
    const sessions = []; const sessionList = document.getElementById('sessionList');
    document.getElementById('createSession').addEventListener('click', ()=>{
      const subj = document.getElementById('sessionSubj').value.trim();
      const date = document.getElementById('sessionDate').value;
      if(!subj || !date) return alert('ادخل الموضوع والتاريخ');
      const link = 'https://meet.example/' + Math.random().toString(36).slice(2,10);
      sessions.unshift({id:Date.now(), subj, date, link});
      renderSessions();
    });
    function renderSessions(){ sessionList.innerHTML = sessions.map(s=>`<div style="padding:8px;border-bottom:1px solid #f0f4f0"><strong>${s.subj}</strong><div class="muted">${s.date}</div><a href="${s.link}" target="_blank">${s.link}</a></div>`).join(''); }

    // Judge chart (demo)
    (function initJudgeChart(){
      const ctx = document.getElementById('judgeChart');
      if(!ctx) return;
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['منجز','قيد','نواقص'],
          datasets:[{data:[1420,85,12], backgroundColor:[getComputedStyle(document.documentElement).getPropertyValue('--gold') || '#FFB703', getComputedStyle(document.documentElement).getPropertyValue('--green') || '#116938', '#ff6b6b']}]
        },
        options:{plugins:{legend:{position:'bottom'}}}
      });
      const t = document.getElementById('todayCases'); if(t) t.textContent = 'قضايا مؤكدة: 27 — عاجلة: 3';
    })();

    // Accessibility: TTS/STT
    document.getElementById('enableTTS').addEventListener('click', ()=>{
      const text = document.getElementById('analysisContent').innerText || 'لا توجد نتائج حالياً';
      if('speechSynthesis' in window){ const u = new SpeechSynthesisUtterance(text); u.lang='ar-SA'; speechSynthesis.speak(u); } else alert('TTS غير مدعوم في متصفحك');
    });
    document.getElementById('startSTT').addEventListener('click', ()=>{
      if(!('SpeechRecognition' in window) && !('webkitSpeechRecognition' in window)) return alert('STT غير مدعوم في متصفحك — اربط خدمة ASR');
      const SR = window.SpeechRecognition || window.webkitSpeechRecognition; const r = new SR();
      r.lang='ar-SA'; r.interimResults=true;
      r.onresult = e => { document.getElementById('facts').value = Array.from(e.results).map(r=>r[0].transcript).join(''); };
      r.onerror = ()=> alert('حدث خطأ في التعرف الصوتي');
      r.start();
    });

    // Theme toggle (light/dim)
    document.getElementById('themeToggle').addEventListener('click', ()=>{
      const root = document.documentElement;
      if(root.style.getPropertyValue('--bg-1') === ''){ // not toggled - use dark by applying dark vars
        root.style.setProperty('--bg-1', '#0b1a15'); root.style.setProperty('--bg-2', '#071018');
        root.style.setProperty('--glass', 'rgba(10,12,10,0.6)');
        document.body.style.color = '#eaf2eb';
      } else {
        // reset to defaults by clearing inline variables
        root.style.removeProperty('--bg-1'); root.style.removeProperty('--bg-2'); root.style.removeProperty('--glass');
        document.body.style.color = '#0b2a1a';
      }
    });

    // Utilities used by UI buttons
    window.openPanel = openPanel;
    window.showIntegration = ()=> alert('تفاصيل التكاملات: OpenAI, Azure Speech, Google OCR, PKI, S3, SSO — يتطلب إعداد خادم ومفاتيح API.');
    window.contactLicensing = ()=> window.location.href = 'mailto:licensing@rawan.dev?subject=طلب%20ترخيص%20رواق%20العدل';
    window.openAudit = ()=> openPanel('assistant');
    window.openServices = ()=> openPanel('services');

    // Initialize default panel
    openPanel('assistant');

    // Keyboard quick navigation (1..6)
    window.addEventListener('keydown', e => {
      if(e.key === '1') openPanel('assistant');
      if(e.key === '2') openPanel('services');
      if(e.key === '3') openPanel('casefile');
      if(e.key === '4') openPanel('memo');
      if(e.key === '5') openPanel('sessions');
      if(e.key === '6') openPanel('judgeboard');
    });
  </script>
</body>
</html>
